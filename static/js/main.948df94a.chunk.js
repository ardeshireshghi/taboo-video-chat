(this.webpackJsonptaboo=this.webpackJsonptaboo||[]).push([[3],{10:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return f}));var c=n(21),i=n(0),o=n(15),r=n(26),s=n(25),a=function(e,t){localStorage.setItem(e,t)},u=function(e){return localStorage.getItem(e)},l=function(e){localStorage.removeItem(e)},b="taboo_accesstoken",j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(o.a)(this,e),this.user=t,this.token=n,this.decodeToken()}return Object(r.a)(e,[{key:"setToken",value:function(e){a(b,e.value),this.token=e,this.decodeToken()}},{key:"decodeToken",value:function(){try{this.token=null!==this.token?this.token:new s.a(u(b)),this.token.value&&(this.user=JSON.parse(atob(this.token.value.split(".")[1])))}catch(e){throw console.error("Error decoding user access token"),e}}},{key:"logout",value:function(){this.token=null,this.user=null,l(b)}},{key:"isAuthenticated",value:function(){return this.user&&Math.floor((new Date).getTime()/1e3)<=this.user.exp}},{key:"getUserInfo",value:function(){return this.user?this.user.context.user:null}}]),e}(),h=n(1),d=Object(i.createContext)(),x=new j,O=function(e){var t=e.children,n=Object(i.useState)(null),o=Object(c.a)(n,2),r=o[0],s=o[1],a=Object(i.useMemo)((function(){return{setToken:function(e){x.setToken(e),s(x.user)},getToken:function(){return x.token},isAuthenticated:function(){return console.log("isAuthenticated?",x.isAuthenticated()),x.isAuthenticated()},logout:function(){x.logout(),s(x.user)},getUser:function(){return null!==r&&void 0!==r?r:x.user}}}),[r,s]);return Object(h.jsx)(d.Provider,{value:a,children:t})},f=function(){var e=Object(i.useContext)(d);if(!e)throw new Error("useAuth must be used inside AuthProvider");return e}},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var c=n(15),i=function e(t){Object(c.a)(this,e),this.value=t}},37:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n.n(c),o=n(23),r=n.n(o);n(37);function s(){return"Loading"}n(38),n(39);var a,u,l,b,j,h,d=n(10),x=n(2),O=n(7),f=n(8),g=n(9),p=n(1),v=g.a.div(a||(a=Object(f.a)(["\n  font-size: 2.5rem;\n  font-family: Helvetica, Arial, sans-serif;\n  font-weight: 900;\n  color: #f44336;\n  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.08), 0 2px 2px rgba(0, 0, 0, 0.08),\n    0 3px 3px rgba(0, 0, 0, 0.08), 0 4px 4px rgba(0, 0, 0, 0.08),\n    0 8px 8px rgba(0, 0, 0, 0.08), 0 16px 16px rgba(0, 0, 0, 0.08);\n  font-style: initial;\n  letter-spacing: -2px;\n"]))),k=g.a.header(u||(u=Object(f.a)(["\n  display: flex;\n  top: 0;\n  position: sticky;\n  background-color: white;\n  z-index: 10;\n  padding: 1rem 3rem;\n  box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.1);\n"]))),m=Object(g.a)(O.b)(l||(l=Object(f.a)(["\n  text-decoration: none;\n  &:hover {\n    text-decoration: none;\n  }\n"]))),y=g.a.nav(b||(b=Object(f.a)(["\n  display: flex;\n  margin-left: auto;\n  align-items: center;\n"]))),w=g.a.ul(j||(j=Object(f.a)(["\n  display: flex;\n  list-style: none;\n  padding: 0;\n  margin: 0;\n"]))),T=g.a.li(h||(h=Object(f.a)(["\n  margin-left: 1rem;\n"]))),A=function(e){var t=e.isLoggedIn,n=void 0!==t&&t;return Object(p.jsxs)(k,{children:[Object(p.jsx)(m,{to:"/",alt:"Taboo chat app",title:"Taboo chat app",children:Object(p.jsx)(v,{children:"Taboo"})}),Object(p.jsx)(y,{children:Object(p.jsxs)(w,{children:[!n&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(T,{children:Object(p.jsx)(O.b,{to:"/login",children:"Login"})}),Object(p.jsx)(T,{children:Object(p.jsx)(O.b,{to:"/signup",children:"Sign up"})})]}),n&&Object(p.jsx)(T,{children:Object(p.jsx)(O.b,{to:"/logout",children:"Logout"})})]})})]})},I=n(22),P=function(e){return(0,Object(d.b)().isAuthenticated)()?Object(p.jsx)(x.b,Object(I.a)({},e)):Object(p.jsx)(x.a,{to:"/signup"})},S=Object(c.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(7)]).then(n.bind(null,207))})),z=Object(c.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(8)]).then(n.bind(null,208))})),L=Object(c.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(10)]).then(n.bind(null,206))})),C=Object(c.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(6)]).then(n.bind(null,205))})),F=Object(c.lazy)((function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,209))})),E=function(){var e=Object(d.b)().logout,t=Object(x.g)();return Object(c.useEffect)((function(){e(),window.location.reload()}),[e,t]),null},J=function(){var e=Object(d.b)().isAuthenticated;return Object(p.jsxs)(O.a,{basename:"/taboo-video-chat",children:[Object(p.jsx)(A,{isLoggedIn:e()}),Object(p.jsxs)(x.d,{children:[Object(p.jsx)(x.b,{path:"/signup",children:Object(p.jsx)(S,{})}),Object(p.jsx)(x.b,{path:"/login",children:Object(p.jsx)(z,{})}),Object(p.jsx)(x.b,{path:"/magic-login",children:Object(p.jsx)(L,{})}),Object(p.jsx)(P,{path:"/choose-topic",children:Object(p.jsx)(C,{})}),Object(p.jsx)(P,{path:"/logout",children:Object(p.jsx)(E,{})}),Object(p.jsx)(P,{path:"/chat/:chatId",children:Object(p.jsx)(F,{})}),Object(p.jsx)(x.b,{path:"/",children:e()?Object(p.jsx)(C,{}):Object(p.jsx)(S,{})})]})]})},M=function(){return Object(p.jsx)(c.Suspense,{fallback:s,children:Object(p.jsx)(d.a,{children:Object(p.jsx)(J,{})})})},B=function(e){e&&e instanceof Function&&n.e(11).then(n.bind(null,204)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),c(e),i(e),o(e),r(e)}))};r.a.render(Object(p.jsx)(i.a.StrictMode,{children:Object(p.jsx)(M,{})}),document.getElementById("root")),B()}},[[46,4,5]]]);
//# sourceMappingURL=main.948df94a.chunk.js.map