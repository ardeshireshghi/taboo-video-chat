{"version":3,"sources":["infrastructure/localStorage.js","services/Auth.js","context/AuthContext.js","domain/AccessToken.js","components/Loader.js","components/MainHeader/MainHeader.js","router/ProtectedRoute.js","router/AppRouter.js","App.js","reportWebVitals.js","index.js"],"names":["LocalStorage","key","value","localStorage","setItem","getItem","removeItem","TOKEN_STORAGE_KEY","Auth","user","token","this","decodeToken","AccessToken","JSON","parse","atob","split","err","console","error","Math","floor","Date","getTime","exp","context","AuthContext","createContext","authService","AuthProvider","children","useState","setUser","authContextValue","useMemo","setToken","getToken","isAuthenticated","log","logout","getUser","Provider","useAuth","contextValue","useContext","Error","Loader","Logo","styled","div","HeaderContainer","header","LogoLink","Link","Nav","nav","NavList","ul","NavItem","li","MainHeader","isLoggedIn","to","alt","title","ProtectedRoute","props","SignUp","lazy","Login","MagicLogin","ChooseTopic","VideoChat","Logout","history","useHistory","useEffect","window","location","reload","AppRouter","path","App","fallback","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"8MAAaA,EAAe,SACtBC,EAAKC,GACPC,aAAaC,QAAQH,EAAKC,IAFjBF,EAAe,SAKtBC,GACF,OAAOE,aAAaE,QAAQJ,IANnBD,EAAe,SASnBC,GACLE,aAAaG,WAAWL,ICPtBM,EAAoB,oBAEbC,EAAb,WACE,aAAwC,IAA5BC,EAA2B,uDAApB,KAAMC,EAAc,uDAAN,KAAM,oBACrCC,KAAKF,KAAOA,EACZE,KAAKD,MAAQA,EAEbC,KAAKC,cALT,4CAQE,SAASF,GACPV,EAAiBO,EAAmBG,EAAMR,OAC1CS,KAAKD,MAAQA,EAEbC,KAAKC,gBAZT,yBAeE,WACE,IACED,KAAKD,MACY,OAAfC,KAAKD,MACDC,KAAKD,MACL,IAAIG,IAAYb,EAAiBO,IAEnCI,KAAKD,MAAMR,QACbS,KAAKF,KAAOK,KAAKC,MAAMC,KAAKL,KAAKD,MAAMR,MAAMe,MAAM,KAAK,MAE1D,MAAOC,GAEP,MADAC,QAAQC,MAAM,oCACRF,KA3BZ,oBA+BE,WACEP,KAAKD,MAAQ,KACbC,KAAKF,KAAO,KACZT,EAAoBO,KAlCxB,6BAqCE,WACE,OACEI,KAAKF,MAAQY,KAAKC,OAAM,IAAIC,MAAOC,UAAY,MAASb,KAAKF,KAAKgB,MAvCxE,yBA2CE,WACE,OAAKd,KAAKF,KAIHE,KAAKF,KAAKiB,QAAQjB,KAHhB,SA7Cb,K,OCCMkB,EAAcC,0BACdC,EAAc,IAAIrB,EAEXsB,EAAe,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SAAe,EACpBC,mBAAS,MADW,mBACrCvB,EADqC,KAC/BwB,EAD+B,KAGtCC,EAAmBC,mBACvB,iBAAO,CACLC,SADK,SACI1B,GACPmB,EAAYO,SAAS1B,GACrBuB,EAAQJ,EAAYpB,OAEtB4B,SALK,WAMH,OAAOR,EAAYnB,OAErB4B,gBARK,WAUH,OADAnB,QAAQoB,IAAI,mBAAoBV,EAAYS,mBACrCT,EAAYS,mBAErBE,OAZK,WAaHX,EAAYW,SACZP,EAAQJ,EAAYpB,OAEtBgC,QAhBK,WAiBH,cAAOhC,QAAP,IAAOA,IAAQoB,EAAYpB,SAG/B,CAACA,EAAMwB,IAGT,OACE,cAACN,EAAYe,SAAb,CAAsBxC,MAAOgC,EAA7B,SACGH,KAKMY,EAAU,WACrB,IAAMC,EAAeC,qBAAWlB,GAChC,IAAKiB,EACH,MAAM,IAAIE,MAAM,4CAElB,OAAOF,I,8EChDI/B,EACX,WAAYX,GAAQ,oBAClBS,KAAKT,MAAQA,I,uGCFF,SAAS6C,IACtB,MAAO,U,uECEHC,EAAOC,IAAOC,IAAV,+YAYJC,EAAkBF,IAAOG,OAAV,gMAUfC,EAAWJ,YAAOK,IAAPL,CAAH,oGAORM,EAAMN,IAAOO,IAAV,4FAMHC,EAAUR,IAAOS,GAAV,gGAOPC,EAAUV,IAAOW,GAAV,kDAIAC,EAAa,SAAC,GAA4B,IAAD,IAAzBC,kBAAyB,SACpD,OACE,eAACX,EAAD,WACE,cAACE,EAAD,CAAUU,GAAG,IAAIC,IAAI,iBAAiBC,MAAM,iBAA5C,SACE,cAACjB,EAAD,sBAEF,cAACO,EAAD,UACE,eAACE,EAAD,YACIK,GACA,qCACE,cAACH,EAAD,UACE,cAAC,IAAD,CAAMI,GAAG,SAAT,qBAEF,cAACJ,EAAD,UACE,cAAC,IAAD,CAAMI,GAAG,UAAT,0BAILD,GACC,cAACH,EAAD,UACE,cAAC,IAAD,CAAMI,GAAG,UAAT,+B,QClEDG,EAAiB,SAACC,GAE7B,OAAK7B,EADuBK,cAApBL,mBAID,cAAC,IAAD,eAAW6B,IAFT,cAAC,IAAD,CAAUJ,GAAG,aCQlBK,EAASC,gBAAK,kBAAM,qEACpBC,EAAQD,gBAAK,kBAAM,qEACnBE,EAAaF,gBAAK,kBAAM,+DACxBG,EAAcH,gBAAK,kBAAM,8DACzBI,EAAYJ,gBAAK,kBAAM,uDAEvBK,EAAS,WAAO,IACZlC,EAAWG,cAAXH,OACFmC,EAAUC,cAMhB,OALAC,qBAAU,WACRrC,IACAsC,OAAOC,SAASC,WACf,CAACxC,EAAQmC,IAEL,MAoCMM,EAjCU,WAAO,IACtB3C,EAAoBK,cAApBL,gBAER,OACE,eAAC,IAAD,WACE,cAAC,EAAD,CAAYwB,WAAYxB,MACxB,eAAC,IAAD,WACE,cAAC,IAAD,CAAO4C,KAAK,UAAZ,SACE,cAACd,EAAD,MAEF,cAAC,IAAD,CAAOc,KAAK,SAAZ,SACE,cAACZ,EAAD,MAEF,cAAC,IAAD,CAAOY,KAAK,eAAZ,SACE,cAACX,EAAD,MAEF,cAAC,EAAD,CAAgBW,KAAK,gBAArB,SACE,cAACV,EAAD,MAEF,cAAC,EAAD,CAAgBU,KAAK,UAArB,SACE,cAAC,EAAD,MAEF,cAAC,EAAD,CAAgBA,KAAK,gBAArB,SACE,cAACT,EAAD,MAEF,cAAC,IAAD,CAAOS,KAAK,IAAZ,SACI5C,IAAiC,cAACkC,EAAD,IAAb,cAACJ,EAAD,aCtCjBe,EAVI,WACjB,OACE,cAAC,WAAD,CAAUC,SAAUrC,EAApB,SACE,cAAC,IAAD,UACE,cAAC,EAAD,SCDOsC,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,+BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCDdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1Bb,M","file":"static/js/main.36139327.chunk.js","sourcesContent":["export const LocalStorage = {\n  set(key, value) {\n    localStorage.setItem(key, value);\n  },\n\n  get(key) {\n    return localStorage.getItem(key);\n  },\n\n  remove(key) {\n    localStorage.removeItem(key);\n  }\n};\n","import { AccessToken } from '../domain/AccessToken';\nimport { LocalStorage } from '../infrastructure/localStorage';\n\nconst TOKEN_STORAGE_KEY = 'taboo_accesstoken';\n\nexport class Auth {\n  constructor(user = null, token = null) {\n    this.user = user;\n    this.token = token;\n\n    this.decodeToken();\n  }\n\n  setToken(token) {\n    LocalStorage.set(TOKEN_STORAGE_KEY, token.value);\n    this.token = token;\n\n    this.decodeToken();\n  }\n\n  decodeToken() {\n    try {\n      this.token =\n        this.token !== null\n          ? this.token\n          : new AccessToken(LocalStorage.get(TOKEN_STORAGE_KEY));\n\n      if (this.token.value) {\n        this.user = JSON.parse(atob(this.token.value.split('.')[1]));\n      }\n    } catch (err) {\n      console.error('Error decoding user access token');\n      throw err;\n    }\n  }\n\n  logout() {\n    this.token = null;\n    this.user = null;\n    LocalStorage.remove(TOKEN_STORAGE_KEY);\n  }\n\n  isAuthenticated() {\n    return (\n      this.user && Math.floor(new Date().getTime() / 1000) <= this.user.exp\n    );\n  }\n\n  getUserInfo() {\n    if (!this.user) {\n      return null;\n    }\n\n    return this.user.context.user;\n  }\n}\n","import { useState } from 'react';\nimport { useMemo } from 'react';\nimport { useContext } from 'react';\nimport { createContext } from 'react';\nimport { Auth } from '../services/Auth';\n\nconst AuthContext = createContext();\nconst authService = new Auth();\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n\n  const authContextValue = useMemo(\n    () => ({\n      setToken(token) {\n        authService.setToken(token);\n        setUser(authService.user);\n      },\n      getToken() {\n        return authService.token;\n      },\n      isAuthenticated() {\n        console.log('isAuthenticated?', authService.isAuthenticated());\n        return authService.isAuthenticated();\n      },\n      logout() {\n        authService.logout();\n        setUser(authService.user);\n      },\n      getUser() {\n        return user ?? authService.user;\n      }\n    }),\n    [user, setUser]\n  );\n\n  return (\n    <AuthContext.Provider value={authContextValue}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const contextValue = useContext(AuthContext);\n  if (!contextValue) {\n    throw new Error('useAuth must be used inside AuthProvider');\n  }\n  return contextValue;\n};\n","export class AccessToken {\n  constructor(value) {\n    this.value = value;\n  }\n}\n","export default function Loader() {\n  return 'Loading';\n}\n","import { Link } from 'react-router-dom';\nimport styled from 'styled-components';\n\nconst Logo = styled.div`\n  font-size: 2.5rem;\n  font-family: Helvetica, Arial, sans-serif;\n  font-weight: 900;\n  color: #f44336;\n  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.08), 0 2px 2px rgba(0, 0, 0, 0.08),\n    0 3px 3px rgba(0, 0, 0, 0.08), 0 4px 4px rgba(0, 0, 0, 0.08),\n    0 8px 8px rgba(0, 0, 0, 0.08), 0 16px 16px rgba(0, 0, 0, 0.08);\n  font-style: initial;\n  letter-spacing: -2px;\n`;\n\nconst HeaderContainer = styled.header`\n  display: flex;\n  top: 0;\n  position: sticky;\n  background-color: white;\n  z-index: 10;\n  padding: 1rem 3rem;\n  box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.1);\n`;\n\nconst LogoLink = styled(Link)`\n  text-decoration: none;\n  &:hover {\n    text-decoration: none;\n  }\n`;\n\nconst Nav = styled.nav`\n  display: flex;\n  margin-left: auto;\n  align-items: center;\n`;\n\nconst NavList = styled.ul`\n  display: flex;\n  list-style: none;\n  padding: 0;\n  margin: 0;\n`;\n\nconst NavItem = styled.li`\n  margin-left: 1rem;\n`;\n\nexport const MainHeader = ({ isLoggedIn = false }) => {\n  return (\n    <HeaderContainer>\n      <LogoLink to=\"/\" alt=\"Taboo chat app\" title=\"Taboo chat app\">\n        <Logo>Taboo</Logo>\n      </LogoLink>\n      <Nav>\n        <NavList>\n          {!isLoggedIn && (\n            <>\n              <NavItem>\n                <Link to=\"/login\">Login</Link>\n              </NavItem>\n              <NavItem>\n                <Link to=\"/signup\">Sign up</Link>\n              </NavItem>\n            </>\n          )}\n          {isLoggedIn && (\n            <NavItem>\n              <Link to=\"/logout\">Logout</Link>\n            </NavItem>\n          )}\n        </NavList>\n      </Nav>\n    </HeaderContainer>\n  );\n};\n","import { Route, Redirect } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\n\nexport const ProtectedRoute = (props) => {\n  const { isAuthenticated } = useAuth();\n  if (!isAuthenticated()) {\n    return <Redirect to=\"/signup\" />;\n  }\n  return <Route {...props} />;\n};\n","import React, { lazy } from 'react';\nimport { useEffect } from 'react';\n\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  useHistory\n} from 'react-router-dom';\nimport { MainHeader } from '../components/MainHeader/MainHeader';\nimport { useAuth } from '../context/AuthContext';\n\nimport { ProtectedRoute } from './ProtectedRoute';\n\nconst SignUp = lazy(() => import('../containers/SignUp'));\nconst Login = lazy(() => import('../containers/Login'));\nconst MagicLogin = lazy(() => import('../containers/MagicLogin'));\nconst ChooseTopic = lazy(() => import('../containers/ChooseTopic'));\nconst VideoChat = lazy(() => import('../containers/VideoChat'));\n\nconst Logout = () => {\n  const { logout } = useAuth();\n  const history = useHistory();\n  useEffect(() => {\n    logout();\n    window.location.reload();\n  }, [logout, history]);\n\n  return null;\n};\n\nexport const AppRouter = () => {\n  const { isAuthenticated } = useAuth();\n\n  return (\n    <Router>\n      <MainHeader isLoggedIn={isAuthenticated()} />\n      <Switch>\n        <Route path=\"/signup\">\n          <SignUp />\n        </Route>\n        <Route path=\"/login\">\n          <Login />\n        </Route>\n        <Route path=\"/magic-login\">\n          <MagicLogin />\n        </Route>\n        <ProtectedRoute path=\"/choose-topic\">\n          <ChooseTopic />\n        </ProtectedRoute>\n        <ProtectedRoute path=\"/logout\">\n          <Logout />\n        </ProtectedRoute>\n        <ProtectedRoute path=\"/chat/:chatId\">\n          <VideoChat />\n        </ProtectedRoute>\n        <Route path=\"/\">\n          {!isAuthenticated() ? <SignUp /> : <ChooseTopic />}\n        </Route>\n      </Switch>\n    </Router>\n  );\n};\n\nexport default AppRouter;\n","import React, { Suspense } from 'react';\nimport Loader from './components/Loader';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'shards-ui/dist/css/shards.min.css';\n\nimport { AuthProvider } from './context/AuthContext';\nimport AppRouter from './router/AppRouter';\n\nexport const App = () => {\n  return (\n    <Suspense fallback={Loader}>\n      <AuthProvider>\n        <AppRouter />\n      </AuthProvider>\n    </Suspense>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}