{"version":3,"sources":["useCases/createTopic.js","components/ChooseTopic/ChooseTopicForm.js","components/shared/SVG/SandClockLoader.js","components/ChooseTopic/LoadingSandClock.js","containers/ChooseTopic.js","hooks/useCreateTopic.js","infrastructure/config.js","hooks/useAsyncSafeState.js","components/shared/CenteredContainer.js","components/shared/DefaultCard.js","domain/Topic.js","domain/Chat.js","components/shared/ButtonWithLoading.js","useCases/getUserChats.js","useCases/updateUserChat.js","hooks/useUserChat.js"],"names":["createTopic","authService","a","name","config","getConfig","accessToken","getToken","value","apiBaseUrl","Error","fetch","method","body","JSON","stringify","headers","Authorization","response","ok","console","error","json","id","topicName","Topic","ChooseTopicForm","submitStatus","onSubmit","useState","setTopicName","handleTopicChosenClick","useCallback","sm","size","DefaultCard","onChange","e","target","placeholder","ButtonWithLoading","pill","onClick","theme","isLoading","SandClockLoader","xmlns","xmlnsXlink","width","height","viewBox","preserveAspectRatio","x","y","attributeName","repeatCount","dur","calcMode","values","keyTimes","keySplines","transform","type","clip-path","fill","d","fadeInAnimation","keyframes","LoadingIconContainer","styled","div","LoadingSandClock","ListGroupItemStyled","ListGroupItem","ChooseTopic","history","useHistory","useAsyncSafeState","loading","setLoading","setError","topic","setTopic","useAuth","create","useMemo","useCreateTopic","useUserChat","getChats","userChats","pollingMaxAttemptsReached","setPollingMaxAttemptsReached","chatPollInterval","useRef","chatPollCounter","pollIntervalSeconds","chatPollIntervalSeconds","chatPollingTimeSeconds","pollMaxRetries","Math","floor","handleChooseTopicSubmit","pollChatWithTimeout","current","setTimeout","useEffect","length","firstNonFullfilledChatWithSameTopic","find","chat","state","ChatState","Fullfilled","push","CenteredContainer","map","to","outline","centered","open","toggle","CONFIG_GLOBAL_KEY","window","Object","keys","REACT_APP_API_URL","CHAT_POLL_INTERVAL","intialValue","mountedRef","setState","update","Container","Card","attrs","this","Pending","PartialJoin","Chat","users","createdAt","updatedAt","Date","spinAnimation","SpinAnimation","ButtonSpinnerWrapper","children","props","toDomain","chats","getUserChats","apiChatToDomain","updateUserChat","chatId","updatedChat","setChats","undefined","setUpdatedChat","updateChat"],"mappings":"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","file":"static/js/6.74adae7e.chunk.js","sourcesContent":["import { Topic } from '../domain/Topic';\n\nimport { getConfig } from '../infrastructure/config';\n\nexport async function createTopic({ name }, authService) {\n  try {\n    const config = getConfig();\n    const accessToken = authService.getToken().value;\n\n    if (!config.apiBaseUrl) {\n      throw new Error('apiBaseUrl is not set in config');\n    }\n\n    const response = await fetch(`${config.apiBaseUrl}/api/v1/topic`, {\n      method: 'POST',\n      body: JSON.stringify({ name }),\n      headers: {\n        'content-type': 'application/json',\n        Authorization: `Bearer ${accessToken}`\n      }\n    });\n\n    if (!response.ok) {\n      console.error(response);\n      throw new Error('Error making request to create topic');\n    }\n    const { id, name: topicName } = await response.json();\n    return new Topic(id, topicName);\n  } catch (err) {\n    console.error('Error creating topic', err);\n    throw err;\n  }\n}\n","import React, { useState } from 'react';\nimport {\n  CardTitle,\n  CardBody,\n  Row,\n  Col,\n  FormGroup,\n  FormInput,\n  Alert\n} from 'shards-react';\n\nimport { useCallback } from 'react';\nimport { DefaultCard } from '../shared/DefaultCard';\nimport { ButtonWithLoading } from '../shared/ButtonWithLoading';\n\nexport default function ChooseTopicForm({ submitStatus, onSubmit = () => {} }) {\n  const [topicName, setTopicName] = useState('');\n\n  const handleTopicChosenClick = useCallback(() => {\n    if (!topicName) {\n      return;\n    }\n\n    onSubmit(topicName);\n  }, [topicName, onSubmit]);\n\n  return (\n    <>\n      <Row>\n        <Col sm={{ size: 12 }}>\n          <DefaultCard>\n            <CardBody>\n              <CardTitle size=\"lg\">Choose a topic</CardTitle>\n              <FormGroup>\n                <FormInput\n                  id=\"#topic\"\n                  size=\"lg\"\n                  value={topicName}\n                  onChange={(e) => setTopicName(e.target.value)}\n                  placeholder=\"e.g Love\"\n                />\n              </FormGroup>\n              <FormGroup>\n                <ButtonWithLoading\n                  pill\n                  size=\"lg\"\n                  onClick={handleTopicChosenClick}\n                  theme=\"success\"\n                  isLoading={submitStatus === 'submitting'}\n                >\n                  Confirm\n                </ButtonWithLoading>\n              </FormGroup>\n            </CardBody>\n          </DefaultCard>\n        </Col>\n      </Row>\n\n      {submitStatus === 'error' && (\n        <Alert theme=\"danger\">\n          There was a problem creating a new topic. Please try later\n        </Alert>\n      )}\n    </>\n  );\n}\n","export function SandClockLoader() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      width=\"100%\"\n      height=\"100%\"\n      viewBox=\"0 0 100 100\"\n      preserveAspectRatio=\"xMidYMid\"\n    >\n      <defs>\n        <clipPath id=\"ldio-7s5wq2mzb7v-cp\">\n          <rect x=\"0\" y=\"0\" width=\"100\" height=\"50\">\n            <animate\n              attributeName=\"y\"\n              repeatCount=\"indefinite\"\n              dur=\"2.2222222222222223s\"\n              calcMode=\"spline\"\n              values=\"0;50;0;0;0\"\n              keyTimes=\"0;0.4;0.5;0.9;1\"\n              keySplines=\"0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7\"\n            ></animate>\n            <animate\n              attributeName=\"height\"\n              repeatCount=\"indefinite\"\n              dur=\"2.2222222222222223s\"\n              calcMode=\"spline\"\n              values=\"50;0;0;50;50\"\n              keyTimes=\"0;0.4;0.5;0.9;1\"\n              keySplines=\"0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7\"\n            ></animate>\n          </rect>\n          <rect x=\"0\" y=\"50\" width=\"100\" height=\"50\">\n            <animate\n              attributeName=\"y\"\n              repeatCount=\"indefinite\"\n              dur=\"2.2222222222222223s\"\n              calcMode=\"spline\"\n              values=\"100;50;50;50;50\"\n              keyTimes=\"0;0.4;0.5;0.9;1\"\n              keySplines=\"0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7\"\n            ></animate>\n            <animate\n              attributeName=\"height\"\n              repeatCount=\"indefinite\"\n              dur=\"2.2222222222222223s\"\n              calcMode=\"spline\"\n              values=\"0;50;50;0;0\"\n              keyTimes=\"0;0.4;0.5;0.9;1\"\n              keySplines=\"0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7;0.3 0 1 0.7\"\n            ></animate>\n          </rect>\n        </clipPath>\n      </defs>\n      <g transform=\"translate(50 50)\">\n        <g transform=\"scale(0.9)\">\n          <g transform=\"translate(-50 -50)\">\n            <g>\n              <animateTransform\n                attributeName=\"transform\"\n                type=\"rotate\"\n                dur=\"2.2222222222222223s\"\n                repeatCount=\"indefinite\"\n                values=\"0 50 50;0 50 50;180 50 50;180 50 50;360 50 50\"\n                keyTimes=\"0;0.4;0.5;0.9;1\"\n              ></animateTransform>\n              <path\n                clip-path=\"url(#ldio-7s5wq2mzb7v-cp)\"\n                fill=\"#e26c00\"\n                d=\"M54.864 50L54.864 50c0-1.291 0.689-2.412 1.671-2.729c9.624-3.107 17.154-12.911 19.347-25.296 c0.681-3.844-1.698-7.475-4.791-7.475H28.908c-3.093 0-5.472 3.631-4.791 7.475c2.194 12.385 9.723 22.189 19.347 25.296 c0.982 0.317 1.671 1.438 1.671 2.729v0c0 1.291-0.689 2.412-1.671 2.729C33.84 55.836 26.311 65.64 24.117 78.025 c-0.681 3.844 1.698 7.475 4.791 7.475h42.184c3.093 0 5.472-3.631 4.791-7.475C73.689 65.64 66.16 55.836 56.536 52.729 C55.553 52.412 54.864 51.291 54.864 50z\"\n              ></path>\n              <path\n                fill=\"#281300\"\n                d=\"M81 81.5h-2.724l0.091-0.578c0.178-1.122 0.17-2.243-0.022-3.333C76.013 64.42 68.103 54.033 57.703 50.483l-0.339-0.116 v-0.715l0.339-0.135c10.399-3.552 18.31-13.938 20.642-27.107c0.192-1.089 0.2-2.211 0.022-3.333L78.276 18.5H81 c2.481 0 4.5-2.019 4.5-4.5S83.481 9.5 81 9.5H19c-2.481 0-4.5 2.019-4.5 4.5s2.019 4.5 4.5 4.5h2.724l-0.092 0.578 c-0.178 1.122-0.17 2.243 0.023 3.333c2.333 13.168 10.242 23.555 20.642 27.107l0.338 0.116v0.715l-0.338 0.135 c-10.4 3.551-18.31 13.938-20.642 27.106c-0.193 1.09-0.201 2.211-0.023 3.333l0.092 0.578H19c-2.481 0-4.5 2.019-4.5 4.5 s2.019 4.5 4.5 4.5h62c2.481 0 4.5-2.019 4.5-4.5S83.481 81.5 81 81.5z M73.14 81.191L73.012 81.5H26.988l-0.128-0.309 c-0.244-0.588-0.491-1.538-0.28-2.729c2.014-11.375 8.944-20.542 17.654-23.354c2.035-0.658 3.402-2.711 3.402-5.108 c0-2.398-1.368-4.451-3.403-5.108c-8.71-2.812-15.639-11.979-17.653-23.353c-0.211-1.191 0.036-2.143 0.281-2.731l0.128-0.308 h46.024l0.128 0.308c0.244 0.589 0.492 1.541 0.281 2.731c-2.015 11.375-8.944 20.541-17.654 23.353 c-2.035 0.658-3.402 2.71-3.402 5.108c0 2.397 1.368 4.45 3.403 5.108c8.71 2.812 15.64 11.979 17.653 23.354 C73.632 79.651 73.384 80.604 73.14 81.191z\"\n              ></path>\n            </g>\n          </g>\n        </g>\n      </g>\n    </svg>\n  );\n}\n","import styled, { keyframes } from 'styled-components';\nimport { SandClockLoader } from '../shared/SVG/SandClockLoader';\n\nconst fadeInAnimation = keyframes`\n  from {\n    opacity: 0;\n    transform: scale(0);\n  }\n\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n`;\n\nconst LoadingIconContainer = styled.div`\n  width: 64px;\n  height: 64px;\n  position: relative;\n  margin: 0 auto;\n  top: -200px;\n  box-sizing: content-box;\n  justify-self: flex-start;\n  opacity: 0;\n  transform: scale(0);\n  animation: ${fadeInAnimation} 0.5s 1 1s;\n  animation-fill-mode: forwards;\n`;\n\nexport function LoadingSandClock() {\n  return (\n    <LoadingIconContainer>\n      <SandClockLoader />\n    </LoadingIconContainer>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport {\n  Modal,\n  ModalBody,\n  ModalHeader,\n  CardBody,\n  CardTitle,\n  ListGroup,\n  ListGroupItem,\n  Button\n} from 'shards-react';\n\nimport { DefaultCard } from '../components/shared/DefaultCard';\nimport { CenteredContainer } from '../components/shared/CenteredContainer';\nimport { useCallback } from 'react';\nimport { useCreateTopic } from '../hooks/useCreateTopic';\n\nimport { ChooseTopicForm, LoadingSandClock } from '../components/ChooseTopic';\nimport { useUserChat } from '../hooks/useUserChat';\nimport { getConfig } from '../infrastructure/config';\nimport { ChatState } from '../domain/Chat';\nimport { useHistory, Link } from 'react-router-dom';\nimport styled from 'styled-components';\n\nconst ListGroupItemStyled = styled(ListGroupItem)`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nexport default function ChooseTopic() {\n  const history = useHistory();\n  const { error, loading, create, topic } = useCreateTopic();\n  const { getChats, userChats } = useUserChat();\n  const [pollingMaxAttemptsReached, setPollingMaxAttemptsReached] =\n    useState(false);\n  const chatPollInterval = useRef(null);\n  const chatPollCounter = useRef(0);\n  const {\n    chatPollIntervalSeconds: pollIntervalSeconds,\n    chatPollingTimeSeconds\n  } = getConfig();\n  const pollMaxRetries = Math.floor(\n    chatPollingTimeSeconds / pollIntervalSeconds\n  );\n\n  const handleChooseTopicSubmit = useCallback(\n    (topicName) => {\n      create({ name: topicName });\n    },\n    [create]\n  );\n\n  const pollChatWithTimeout = useCallback(() => {\n    getChats();\n    chatPollCounter.current += 1;\n\n    if (chatPollCounter.current <= pollMaxRetries) {\n      chatPollInterval.current = setTimeout(() => {\n        pollChatWithTimeout();\n      }, pollIntervalSeconds * 1000);\n    } else {\n      setPollingMaxAttemptsReached(true);\n    }\n  }, [\n    getChats,\n    pollIntervalSeconds,\n    chatPollCounter,\n    pollMaxRetries,\n    setPollingMaxAttemptsReached\n  ]);\n\n  useEffect(() => {\n    if (topic && !chatPollInterval.current) {\n      pollChatWithTimeout();\n    }\n  }, [topic, chatPollInterval, pollChatWithTimeout, getChats]);\n\n  useEffect(() => {\n    getChats();\n  }, [getChats]);\n\n  useEffect(() => {\n    if (userChats.length && topic) {\n      const firstNonFullfilledChatWithSameTopic = userChats.find(\n        (chat) =>\n          chat.state !== ChatState.Fullfilled && chat.topic.name === topic.name\n      );\n\n      if (firstNonFullfilledChatWithSameTopic) {\n        history.push(`/chat/${firstNonFullfilledChatWithSameTopic.id}`);\n      }\n    }\n  }, [userChats, history, topic]);\n\n  return (\n    <CenteredContainer>\n      {!topic && (\n        <ChooseTopicForm\n          onSubmit={handleChooseTopicSubmit}\n          submitStatus={loading ? 'submitting' : error ? 'error' : 'pending'}\n        />\n      )}\n      {userChats.length > 0 && !topic && (\n        <DefaultCard>\n          <CardBody>\n            <CardTitle>Active chats with matched topics</CardTitle>\n            <ListGroup>\n              {userChats.map((chat) => (\n                <ListGroupItemStyled key={chat.id}>\n                  {chat.topic.name}\n\n                  <Link to={`/chat/${chat.id}`}>\n                    <Button outline pill size=\"sm\">\n                      Go to chat\n                    </Button>\n                  </Link>\n                </ListGroupItemStyled>\n              ))}\n            </ListGroup>\n          </CardBody>\n        </DefaultCard>\n      )}\n\n      {topic && (\n        <>\n          {!pollingMaxAttemptsReached && <LoadingSandClock />}\n          <Modal centered open={true} toggle={() => {}}>\n            {!pollingMaxAttemptsReached && (\n              <>\n                <ModalHeader>Thanks 🙏</ModalHeader>\n                <ModalBody>\n                  Please wait while we find a person with interest in{' '}\n                  <strong>\"{topic.name}\"</strong>.\n                </ModalBody>\n              </>\n            )}\n            {pollingMaxAttemptsReached && (\n              <>\n                <ModalHeader>No matches found 😞</ModalHeader>\n                <ModalBody>\n                  Looks like your topic of interest has not found any match yet.\n                  We will notify you once we find a match.\n                </ModalBody>\n              </>\n            )}\n          </Modal>\n        </>\n      )}\n    </CenteredContainer>\n  );\n}\n","import { useCallback } from 'react';\nimport { useMemo } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { createTopic } from '../useCases/createTopic';\nimport useAsyncSafeState from './useAsyncSafeState';\n\nexport function useCreateTopic() {\n  const [loading, setLoading] = useAsyncSafeState(false);\n  const [error, setError] = useAsyncSafeState(null);\n  const [topic, setTopic] = useAsyncSafeState(null);\n  const authService = useAuth();\n\n  const create = useCallback(\n    async ({ name }) => {\n      setLoading(true);\n\n      try {\n        const topic = await createTopic({ name }, authService);\n        setTopic(topic);\n      } catch (err) {\n        setError(err);\n      } finally {\n        setLoading(false);\n      }\n    },\n    [setLoading, setError, authService, setTopic]\n  );\n\n  return useMemo(\n    () => ({\n      loading,\n      error,\n      create,\n      topic\n    }),\n    [loading, error, create, topic]\n  );\n}\n","const CONFIG_GLOBAL_KEY = '__RUNTIME_CONFIG__';\nlet config = {};\n\nexport function getConfig() {\n  if (!(CONFIG_GLOBAL_KEY in window)) {\n    return config;\n  }\n\n  if (Object.keys(config).length === 0) {\n    config = {\n      apiBaseUrl: window[CONFIG_GLOBAL_KEY].REACT_APP_API_URL,\n      chatPollIntervalSeconds:\n        window[CONFIG_GLOBAL_KEY].CHAT_POLL_INTERVAL || 10,\n      chatPollingTimeSeconds: 300\n    };\n\n    delete window[CONFIG_GLOBAL_KEY];\n  }\n\n  return config;\n}\n","import { useRef, useEffect, useState, useCallback } from 'react';\n\nfunction useAsyncSafeState(intialValue) {\n  const mountedRef = useRef(false);\n  const [state, setState] = useState(intialValue);\n\n  useEffect(() => {\n    mountedRef.current = true;\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  const safeSetState = useCallback(\n    (update) => {\n      if (mountedRef.current) {\n        setState(update);\n      }\n    },\n    [setState]\n  );\n\n  return [state, safeSetState];\n}\n\nexport default useAsyncSafeState;\n","import { Container } from 'shards-react';\nimport styled from 'styled-components';\n\nexport const CenteredContainer = styled(Container)`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  gap: 1rem;\n  flex-wrap: wrap;\n  min-height: calc(100% - 92px);\n\n  > *:first-child {\n    flex-basis: auto;\n  }\n`;\n","import { Card } from 'shards-react';\nimport styled from 'styled-components';\n\nexport const DefaultCard = styled(Card).attrs({\n  outline: false\n})`\n  width: 400px;\n  max-width: 100%;\n`;\n","export class Topic {\n  constructor(id, name) {\n    this.id = id;\n    this.name = name;\n  }\n}\n","export const ChatState = {\n  Pending: 'pending',\n  PartialJoin: 'partial_join',\n  Fullfilled: 'fullfilled'\n};\n\nexport class Chat {\n  constructor(id, { topic, users, state, createdAt, updatedAt }) {\n    this.id = id;\n    this.topic = topic;\n    this.users = users;\n    this.state = state;\n    this.createdAt = new Date(createdAt);\n    this.updatedAt = new Date(updatedAt);\n  }\n}\n","import React from 'react';\nimport { CgSpinner } from 'react-icons/cg';\nimport { Button } from 'shards-react';\nimport styled, { keyframes } from 'styled-components';\n\nconst spinAnimation = keyframes`\n  0% {\n    transform: rotateZ(0)\n  }\n\n  100% {\n    transform: rotateZ(360deg)\n  }\n`;\n\nconst SpinAnimation = styled.div`\n  animation: ${spinAnimation} infinite;\n  animation-duration: 1s;\n  animation-timing-function: linear;\n`;\nconst ButtonSpinnerWrapper = styled.div`\n  margin-left: 0.5rem;\n  display: inline-block;\n  line-height: 0;\n`;\n\nexport const ButtonWithLoading = ({\n  isLoading = false,\n  children,\n  ...props\n}) => {\n  return (\n    <Button {...props}>\n      {children}\n      {isLoading && (\n        <ButtonSpinnerWrapper>\n          <SpinAnimation>\n            <CgSpinner />\n          </SpinAnimation>\n        </ButtonSpinnerWrapper>\n      )}\n    </Button>\n  );\n};\n","import { Chat } from '../domain/Chat';\nimport { Topic } from '../domain/Topic';\n\nimport { getConfig } from '../infrastructure/config';\n\nfunction toDomain(chats) {\n  return chats.map((chat) => {\n    const topic = new Topic(chat.topic.id, chat.topic.name);\n\n    return new Chat(chat.id, {\n      ...chat,\n      topic\n    });\n  });\n}\nexport async function getUserChats(authService) {\n  try {\n    const config = getConfig();\n    const accessToken = authService.getToken().value;\n\n    if (!config.apiBaseUrl) {\n      throw new Error('apiBaseUrl is not set in config');\n    }\n\n    const response = await fetch(`${config.apiBaseUrl}/api/v1/chat`, {\n      method: 'GET',\n      headers: {\n        'content-type': 'application/json',\n        Authorization: `Bearer ${accessToken}`\n      }\n    });\n\n    if (!response.ok) {\n      console.error(response);\n      throw new Error('Error making request to fetch user chats');\n    }\n    const chats = await response.json();\n\n    return toDomain(chats);\n  } catch (err) {\n    console.error('Error fetching chats', err);\n    throw err;\n  }\n}\n","import { Chat } from '../domain/Chat';\nimport { Topic } from '../domain/Topic';\n\nimport { getConfig } from '../infrastructure/config';\n\nfunction apiChatToDomain(chat) {\n  const topic = new Topic(chat.topic.id, chat.topic.name);\n\n  return new Chat(chat.id, {\n    ...chat,\n    topic\n  });\n}\n\nexport async function updateUserChat(chatId, authService) {\n  try {\n    const config = getConfig();\n    const accessToken = authService.getToken().value;\n\n    if (!config.apiBaseUrl) {\n      throw new Error('apiBaseUrl is not set in config');\n    }\n\n    const response = await fetch(`${config.apiBaseUrl}/api/v1/chat/${chatId}`, {\n      method: 'PUT',\n      headers: {\n        'content-type': 'application/json',\n        Authorization: `Bearer ${accessToken}`\n      }\n    });\n\n    if (!response.ok) {\n      console.error(response);\n      throw new Error(`Error updating user chat id ${chatId}`);\n    }\n    const updatedChat = await response.json();\n\n    return apiChatToDomain(updatedChat);\n  } catch (err) {\n    console.error('Error updating chat', err);\n    throw err;\n  }\n}\n","import { useCallback } from 'react';\nimport { useMemo } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { getUserChats } from '../useCases/getUserChats';\nimport { updateUserChat } from '../useCases/updateUserChat';\nimport useAsyncSafeState from './useAsyncSafeState';\n\nexport function useUserChat() {\n  const [loading, setLoading] = useAsyncSafeState(false);\n  const [error, setError] = useAsyncSafeState(null);\n  const [userChats, setChats] = useAsyncSafeState([]);\n  const [updatedChat, setUpdatedChat] = useAsyncSafeState(undefined);\n  const authService = useAuth();\n\n  const getChats = useCallback(async () => {\n    setLoading(true);\n\n    try {\n      const userChats = await getUserChats(authService);\n      setChats(userChats);\n    } catch (err) {\n      setError(err);\n    } finally {\n      setLoading(false);\n    }\n  }, [setLoading, setError, authService, setChats]);\n\n  const updateChat = useCallback(\n    async (chatId) => {\n      setLoading(true);\n\n      try {\n        const updatedChat = await updateUserChat(chatId, authService);\n        setUpdatedChat(updatedChat);\n      } catch (err) {\n        setError(err);\n      } finally {\n        setLoading(false);\n      }\n    },\n    [setLoading, setError, authService, setUpdatedChat]\n  );\n\n  return useMemo(\n    () => ({\n      loading,\n      error,\n      getChats,\n      userChats,\n      updateChat,\n      updatedChat\n    }),\n    [loading, error, getChats, updateChat, userChats, updatedChat]\n  );\n}\n"],"sourceRoot":""}